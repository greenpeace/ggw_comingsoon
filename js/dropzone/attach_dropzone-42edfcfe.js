"use strict";!function($){var dragging,draggingHeight,placeholders=$();$.fn.sortable=function(options){var method=String(options);return options=$.extend({connectWith:!1,placeholder:null,dragImage:null},options),this.each(function(){var index,items=$(this).children(options.items),handles=options.handle?items.find(options.handle):items;if("reload"===method&&$(this).children(options.items).off("dragstart.h5s dragend.h5s selectstart.h5s dragover.h5s dragenter.h5s drop.h5s"),/^enable|disable|destroy$/.test(method)){var citems=$(this).children($(this).data("items")).attr("draggable","enable"===method);return void("destroy"===method&&($(this).off("sortupdate"),$(this).removeData("opts"),citems.add(this).removeData("connectWith items").off("dragstart.h5s dragend.h5s dragover.h5s dragenter.h5s drop.h5s").off("sortupdate"),handles.off("selectstart.h5s")))}var soptions=$(this).data("opts");"undefined"==typeof soptions?$(this).data("opts",options):options=soptions;var startParent,newParent,placeholder=null===options.placeholder?$("<"+(/^ul|ol$/i.test(this.tagName)?"li":"div")+' class="sortable-placeholder"/>'):$(options.placeholder).addClass("sortable-placeholder");$(this).data("items",options.items),placeholders=placeholders.add(placeholder),options.connectWith&&$(options.connectWith).add(this).data("connectWith",options.connectWith),items.attr("role","option"),items.attr("aria-grabbed","false"),handles.attr("draggable","true").not("a[href], img").on("selectstart.h5s",function(){return this.dragDrop&&this.dragDrop(),!1}).end(),items.on("dragstart.h5s",function(e){var dt=e.originalEvent.dataTransfer;dt.effectAllowed="move",dt.setData("text",""),options.dragImage&&dt.setDragImage&&dt.setDragImage(options.dragImage,0,0),index=(dragging=$(this)).addClass("sortable-dragging").attr("aria-grabbed","true").index(),draggingHeight=dragging.outerHeight(),startParent=$(this).parent(),dragging.parent().triggerHandler("sortstart",{item:dragging,startparent:startParent})}).on("dragend.h5s",function(){dragging&&(dragging.removeClass("sortable-dragging").attr("aria-grabbed","false").show(),placeholders.detach(),newParent=$(this).parent(),(index!==dragging.index()||startParent.get(0)!==newParent.get(0))&&dragging.parent().triggerHandler("sortupdate",{item:dragging,oldindex:index,startparent:startParent,endparent:newParent}),dragging=null,draggingHeight=null)}).add([this,placeholder]).on("dragover.h5s dragenter.h5s drop.h5s",function(e){if(!items.is(dragging)&&options.connectWith!==$(dragging).parent().data("connectWith"))return!0;if("drop"===e.type)return e.stopPropagation(),placeholders.filter(":visible").after(dragging),dragging.trigger("dragend.h5s"),!1;if(e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="move",items.is(this)){var thisHeight=$(this).outerHeight();if(options.forcePlaceholderSize&&placeholder.height(draggingHeight),thisHeight>draggingHeight){var deadZone=thisHeight-draggingHeight,offsetTop=$(this).offset().top;if(placeholder.index()<$(this).index()&&e.originalEvent.pageY<offsetTop+deadZone)return!1;if(placeholder.index()>$(this).index()&&e.originalEvent.pageY>offsetTop+thisHeight-deadZone)return!1}dragging.hide(),$(this)[placeholder.index()<$(this).index()?"after":"before"](placeholder),placeholders.not(placeholder).detach()}else placeholders.is(this)||$(this).children(options.items).length||(placeholders.detach(),$(this).append(placeholder));return!1})})}}(jQuery),$(function(){$("#previews").sortable({handle:".preview",items:":not(.disabled)"});var previewNode=$("#template");previewNode.removeAttr("id");var previewTemplate=previewNode.parent().html();if($(previewNode).remove(),$("body").hasClass("page-type-photo"))var myDropzone=new Dropzone(document.body,{url:"http://www.tubanters.nl/tmp/upload.php",thumbnailWidth:80,thumbnailHeight:80,parallelUploads:20,maxFilesize:3,acceptedFiles:"image/*",accept:function(file,done){var pixels=0,reader=new FileReader;reader.onload=function(file){var image=new Image;image.src=file.target.result,image.onload=function(){pixels=this.width*this.height,2e4>pixels?done("This file is too small"):done()}},reader.readAsDataURL(file)},previewTemplate:previewTemplate,previewsContainer:"#previews",clickable:".fileinput-button"});else if($("body").hasClass("page-type-document")){var myDropzone=new Dropzone(document.body,{url:"http://www.tubanters.nl/tmp/upload.php",thumbnailWidth:80,thumbnailHeight:80,parallelUploads:20,maxFilesize:15,acceptedFiles:".doc, .docx, .xls, .xlsx, .ppt, .pptx, .odt, .odp, .ods, .pdf",previewTemplate:previewTemplate,previewsContainer:"#previews",clickable:".fileinput-button"});myDropzone.on("addedfile",function(file){var ext=file.name.split(".").pop();file.previewElement.querySelector(".image-preview").className+=" "+ext,file.previewElement.querySelector(".image-preview").innerHTML=""})}myDropzone.on("addedfile",function(file){$("#previews").sortable("reload"),$(".dropzone-droparea").addClass("dz-started"),file.previewElement.querySelector(".start").onclick=function(){myDropzone.enqueueFile(file)}}),myDropzone.on("error",function(file){file.previewElement.querySelector(".preview").style.opacity=".5",file.previewElement.querySelector(".name").remove(),file.previewElement.querySelector(".start").remove()}),myDropzone.on("totaluploadprogress",function(progress){$("#total-progress .progress-bar").css("width",progress+"%")}),myDropzone.on("sending",function(file){$("#total-progress").css("opacity","1"),file.previewElement.querySelector(".start").setAttribute("disabled","disabled")}),myDropzone.on("queuecomplete",function(){$("#total-progress").css("opacity","0")}),$("#dropzone-actions .start").on("click",function(){myDropzone.enqueueFiles(myDropzone.getFilesWithStatus(Dropzone.ADDED)),$("#previews").sortable("reload")}),$("#dropzone-actions .cancel").on("click",function(){myDropzone.removeAllFiles(!0),$(".dropzone-droparea").removeClass("dz-started")})});