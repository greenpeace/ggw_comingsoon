!function($){$.fn.autogrow=function(opts){function resize(e){var clone,box=$(this),oldHeight=box.innerHeight(),newHeight=this.scrollHeight,minHeight=box.data("autogrow-start-height")||0;if(newHeight>oldHeight)this.scrollTop=0,opts.animate?box.stop().animate({height:newHeight},opts.speed):box.innerHeight(newHeight);else if(!e||8==e.which||46==e.which||e.ctrlKey&&88==e.which)if(oldHeight>minHeight){clone=box.clone().addClass(opts.cloneClass).css({position:"absolute",zIndex:-10,height:""}).val(box.val()),box.after(clone);do newHeight=clone[0].scrollHeight-1,clone.innerHeight(newHeight);while(newHeight===clone[0].scrollHeight);newHeight++,clone.remove(),box.focus(),minHeight>newHeight&&(newHeight=minHeight),oldHeight>newHeight&&opts.animate?box.stop().animate({height:newHeight},opts.speed):box.innerHeight(newHeight)}else box.innerHeight(minHeight)}var that=$(this).css({overflow:"hidden",resize:"none"}),selector=that.selector,defaults={context:$(document),animate:!0,speed:200,fixMinHeight:!0,cloneClass:"autogrowclone",onInitialize:!1};return opts=$.isPlainObject(opts)?opts:{context:opts?opts:$(document)},opts=$.extend({},defaults,opts),that.each(function(i,elem){var min,clone;elem=$(elem),elem.is(":visible")||parseInt(elem.css("height"),10)>0?min=parseInt(elem.css("height"),10)||elem.innerHeight():(clone=elem.clone().addClass(opts.cloneClass).val(elem.val()).css({position:"absolute",visibility:"hidden",display:"block"}),$("body").append(clone),min=clone.innerHeight(),clone.remove()),opts.fixMinHeight&&elem.data("autogrow-start-height",min),elem.css("height",min),opts.onInitialize&&resize.call(elem)}),opts.context.on("keyup paste",selector,resize),that}}(jQuery);